{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "01ecc86d",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "155e56dd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:20.301765Z",
     "iopub.status.busy": "2022-07-11T16:32:20.301477Z",
     "iopub.status.idle": "2022-07-11T16:32:24.710760Z",
     "shell.execute_reply": "2022-07-11T16:32:24.710123Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-07-11 16:32:21.266551: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-07-11 16:32:21.266579: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/circleci/project/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.decorator.check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "/home/circleci/project/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.inheritance.inherit_check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import reduce_in_tests\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3bcff0ba",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "168f019f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:24.714103Z",
     "iopub.status.busy": "2022-07-11T16:32:24.713649Z",
     "iopub.status.idle": "2022-07-11T16:32:24.716917Z",
     "shell.execute_reply": "2022-07-11T16:32:24.716299Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "65d72c93",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "169a853e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:24.719672Z",
     "iopub.status.busy": "2022-07-11T16:32:24.719402Z",
     "iopub.status.idle": "2022-07-11T16:32:24.722437Z",
     "shell.execute_reply": "2022-07-11T16:32:24.721937Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = reduce_in_tests(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "434903cf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:24.724889Z",
     "iopub.status.busy": "2022-07-11T16:32:24.724634Z",
     "iopub.status.idle": "2022-07-11T16:32:24.863325Z",
     "shell.execute_reply": "2022-07-11T16:32:24.862449Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f6c1ae0f2e0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "5fbf8342",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:24.867392Z",
     "iopub.status.busy": "2022-07-11T16:32:24.866922Z",
     "iopub.status.idle": "2022-07-11T16:32:24.919129Z",
     "shell.execute_reply": "2022-07-11T16:32:24.918512Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/circleci/project/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.checker.ShapeChecker.__init__ which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "2022-07-11 16:32:24.870133: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-07-11 16:32:24.870161: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-07-11 16:32:24.870180: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (307ccffa4c75): /proc/driver/nvidia/version does not exist\n",
      "2022-07-11 16:32:24.870432: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f6c1ae24040&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value  </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]</td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.01   </td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f6c1ae24040>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤═════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value   │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪═════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0     │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼─────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.] │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼─────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0     │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼─────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.01    │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧═════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "47cc6581",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:24.921818Z",
     "iopub.status.busy": "2022-07-11T16:32:24.921502Z",
     "iopub.status.idle": "2022-07-11T16:32:25.083409Z",
     "shell.execute_reply": "2022-07-11T16:32:25.082806Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "86732bc8",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "49ab768a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:25.086181Z",
     "iopub.status.busy": "2022-07-11T16:32:25.085889Z",
     "iopub.status.idle": "2022-07-11T16:32:25.101718Z",
     "shell.execute_reply": "2022-07-11T16:32:25.101080Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b5b077d8",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "4fc2fe0a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:25.127089Z",
     "iopub.status.busy": "2022-07-11T16:32:25.126707Z",
     "iopub.status.idle": "2022-07-11T16:32:25.130675Z",
     "shell.execute_reply": "2022-07-11T16:32:25.130093Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "8c16e668",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:25.133315Z",
     "iopub.status.busy": "2022-07-11T16:32:25.133019Z",
     "iopub.status.idle": "2022-07-11T16:32:30.900588Z",
     "shell.execute_reply": "2022-07-11T16:32:30.899927Z"
    }
   },
   "outputs": [],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5fb06afa",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a1e15ddf",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "006b1aa4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:30.903900Z",
     "iopub.status.busy": "2022-07-11T16:32:30.903603Z",
     "iopub.status.idle": "2022-07-11T16:32:30.908308Z",
     "shell.execute_reply": "2022-07-11T16:32:30.907772Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "676012ac",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "3d047c91",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:30.911039Z",
     "iopub.status.busy": "2022-07-11T16:32:30.910778Z",
     "iopub.status.idle": "2022-07-11T16:32:34.199105Z",
     "shell.execute_reply": "2022-07-11T16:32:34.198393Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "00047444",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3dd9c1df",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "51f93a65",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:34.203283Z",
     "iopub.status.busy": "2022-07-11T16:32:34.202963Z",
     "iopub.status.idle": "2022-07-11T16:32:34.219042Z",
     "shell.execute_reply": "2022-07-11T16:32:34.218360Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "220daa71",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-11T16:32:34.222713Z",
     "iopub.status.busy": "2022-07-11T16:32:34.222421Z",
     "iopub.status.idle": "2022-07-11T16:32:36.233098Z",
     "shell.execute_reply": "2022-07-11T16:32:36.232308Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889758\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735859e-04, -4.30340709e-04,  3.97830747e-04,  2.26009893e-06,\n",
       "        4.29147212e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005976,   1.74612938,   0.18194306, -15.21875416,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a4a8ee10",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
