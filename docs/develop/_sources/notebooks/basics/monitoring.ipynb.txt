{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "7534c7e4",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "d6f6ae6a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:22.224156Z",
     "iopub.status.busy": "2022-07-06T14:23:22.223867Z",
     "iopub.status.idle": "2022-07-06T14:23:25.983464Z",
     "shell.execute_reply": "2022-07-06T14:23:25.982675Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-07-06 14:23:23.179110: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-07-06 14:23:23.179139: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/circleci/project/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.decorator.check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "/home/circleci/project/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.inheritance.inherit_check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import reduce_in_tests\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e8774a65",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "98bb13bf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:25.986881Z",
     "iopub.status.busy": "2022-07-06T14:23:25.986431Z",
     "iopub.status.idle": "2022-07-06T14:23:25.990025Z",
     "shell.execute_reply": "2022-07-06T14:23:25.989348Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "47165a76",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "628d3f5c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:25.992582Z",
     "iopub.status.busy": "2022-07-06T14:23:25.992333Z",
     "iopub.status.idle": "2022-07-06T14:23:25.995553Z",
     "shell.execute_reply": "2022-07-06T14:23:25.994938Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = reduce_in_tests(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "f0e0b8e4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:25.997913Z",
     "iopub.status.busy": "2022-07-06T14:23:25.997666Z",
     "iopub.status.idle": "2022-07-06T14:23:26.108291Z",
     "shell.execute_reply": "2022-07-06T14:23:26.107489Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f61240ef670>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "04c811bb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:26.111050Z",
     "iopub.status.busy": "2022-07-06T14:23:26.110761Z",
     "iopub.status.idle": "2022-07-06T14:23:26.164843Z",
     "shell.execute_reply": "2022-07-06T14:23:26.164237Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/circleci/project/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.checker.ShapeChecker.__init__ which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "2022-07-06 14:23:26.113604: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-07-06 14:23:26.113630: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-07-06 14:23:26.113650: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (65d0a3501d57): /proc/driver/nvidia/version does not exist\n",
      "2022-07-06 14:23:26.113881: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f611fe43e80&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value  </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]</td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.01   </td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f611fe43e80>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤═════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value   │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪═════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0     │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼─────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.] │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼─────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0     │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼─────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.01    │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧═════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "75385739",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:26.167521Z",
     "iopub.status.busy": "2022-07-06T14:23:26.167227Z",
     "iopub.status.idle": "2022-07-06T14:23:26.467449Z",
     "shell.execute_reply": "2022-07-06T14:23:26.466835Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6e130808",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "3ae04465",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:26.470227Z",
     "iopub.status.busy": "2022-07-06T14:23:26.469946Z",
     "iopub.status.idle": "2022-07-06T14:23:26.485476Z",
     "shell.execute_reply": "2022-07-06T14:23:26.484886Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "676ea53c",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "09e57851",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:26.488462Z",
     "iopub.status.busy": "2022-07-06T14:23:26.488188Z",
     "iopub.status.idle": "2022-07-06T14:23:26.491898Z",
     "shell.execute_reply": "2022-07-06T14:23:26.491254Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "b42bb274",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:26.494804Z",
     "iopub.status.busy": "2022-07-06T14:23:26.494550Z",
     "iopub.status.idle": "2022-07-06T14:23:33.510487Z",
     "shell.execute_reply": "2022-07-06T14:23:33.509705Z"
    }
   },
   "outputs": [],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "69494117",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "81b29514",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "03b19b06",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:33.553847Z",
     "iopub.status.busy": "2022-07-06T14:23:33.553488Z",
     "iopub.status.idle": "2022-07-06T14:23:33.558646Z",
     "shell.execute_reply": "2022-07-06T14:23:33.558086Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b60d1b6c",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "15ff39da",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:33.561083Z",
     "iopub.status.busy": "2022-07-06T14:23:33.560834Z",
     "iopub.status.idle": "2022-07-06T14:23:35.529537Z",
     "shell.execute_reply": "2022-07-06T14:23:35.528889Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b624ea63",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f3c42e96",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "6a2ffe79",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:35.532739Z",
     "iopub.status.busy": "2022-07-06T14:23:35.532435Z",
     "iopub.status.idle": "2022-07-06T14:23:35.719971Z",
     "shell.execute_reply": "2022-07-06T14:23:35.719315Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "e351b845",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-06T14:23:35.722998Z",
     "iopub.status.busy": "2022-07-06T14:23:35.722701Z",
     "iopub.status.idle": "2022-07-06T14:23:37.663847Z",
     "shell.execute_reply": "2022-07-06T14:23:37.663228Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889758\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735859e-04, -4.30340709e-04,  3.97830747e-04,  2.26009893e-06,\n",
       "        4.29147212e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005976,   1.74612938,   0.18194306, -15.21875416,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5099657",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
