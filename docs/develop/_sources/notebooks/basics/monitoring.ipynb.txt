{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "c82ce4d1",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "4d8f35a2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:26:52.469681Z",
     "iopub.status.busy": "2022-07-20T13:26:52.469381Z",
     "iopub.status.idle": "2022-07-20T13:26:56.642466Z",
     "shell.execute_reply": "2022-07-20T13:26:56.641773Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2022-07-20 13:26:53.413632: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n",
      "2022-07-20 13:26:53.413659: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/circleci/project/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.decorator.check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "/home/circleci/project/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.inheritance.inherit_check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import reduce_in_tests\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2d2ac91a",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "5bf3321c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:26:56.645871Z",
     "iopub.status.busy": "2022-07-20T13:26:56.645379Z",
     "iopub.status.idle": "2022-07-20T13:26:56.648915Z",
     "shell.execute_reply": "2022-07-20T13:26:56.648380Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4c2c19d6",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "d38c7ab0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:26:56.651373Z",
     "iopub.status.busy": "2022-07-20T13:26:56.651113Z",
     "iopub.status.idle": "2022-07-20T13:26:56.654040Z",
     "shell.execute_reply": "2022-07-20T13:26:56.653509Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = reduce_in_tests(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "bc0c49f2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:26:56.656382Z",
     "iopub.status.busy": "2022-07-20T13:26:56.656099Z",
     "iopub.status.idle": "2022-07-20T13:26:56.749556Z",
     "shell.execute_reply": "2022-07-20T13:26:56.748940Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f33e05ac070>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "3e383c6d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:26:56.752327Z",
     "iopub.status.busy": "2022-07-20T13:26:56.752007Z",
     "iopub.status.idle": "2022-07-20T13:26:56.804205Z",
     "shell.execute_reply": "2022-07-20T13:26:56.803581Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/circleci/project/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.checker.ShapeChecker.__init__ which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "2022-07-20 13:26:56.754681: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\n",
      "2022-07-20 13:26:56.754706: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)\n",
      "2022-07-20 13:26:56.754727: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (743ae1591448): /proc/driver/nvidia/version does not exist\n",
      "2022-07-20 13:26:56.754986: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f33e05ae4d0&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value  </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]</td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.01   </td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f33e05ae4d0>\n",
       "╒════════════════════════════════════╤═══════════╤══════════════════╤═════════╤═════════════╤═════════╤═════════╤═════════╕\n",
       "│ name                               │ class     │ transform        │ prior   │ trainable   │ shape   │ dtype   │ value   │\n",
       "╞════════════════════════════════════╪═══════════╪══════════════════╪═════════╪═════════════╪═════════╪═════════╪═════════╡\n",
       "│ GPR.kernel.kernels[0].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0     │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼─────────┤\n",
       "│ GPR.kernel.kernels[0].lengthscales │ Parameter │ Softplus         │         │ True        │ (2,)    │ float64 │ [1. 2.] │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼─────────┤\n",
       "│ GPR.kernel.kernels[1].variance     │ Parameter │ Softplus         │         │ True        │ ()      │ float64 │ 1.0     │\n",
       "├────────────────────────────────────┼───────────┼──────────────────┼─────────┼─────────────┼─────────┼─────────┼─────────┤\n",
       "│ GPR.likelihood.variance            │ Parameter │ Softplus + Shift │         │ True        │ ()      │ float64 │ 0.01    │\n",
       "╘════════════════════════════════════╧═══════════╧══════════════════╧═════════╧═════════════╧═════════╧═════════╧═════════╛"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "964a0c41",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:26:56.807053Z",
     "iopub.status.busy": "2022-07-20T13:26:56.806766Z",
     "iopub.status.idle": "2022-07-20T13:26:56.958830Z",
     "shell.execute_reply": "2022-07-20T13:26:56.958235Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "85696c66",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "c687c82b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:26:56.961705Z",
     "iopub.status.busy": "2022-07-20T13:26:56.961409Z",
     "iopub.status.idle": "2022-07-20T13:26:56.977210Z",
     "shell.execute_reply": "2022-07-20T13:26:56.976621Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "225fbdf0",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "1af99b1f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:26:57.018063Z",
     "iopub.status.busy": "2022-07-20T13:26:57.017687Z",
     "iopub.status.idle": "2022-07-20T13:26:57.021481Z",
     "shell.execute_reply": "2022-07-20T13:26:57.020943Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "6c1f5b9f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:26:57.023998Z",
     "iopub.status.busy": "2022-07-20T13:26:57.023739Z",
     "iopub.status.idle": "2022-07-20T13:27:02.429969Z",
     "shell.execute_reply": "2022-07-20T13:27:02.429109Z"
    }
   },
   "outputs": [],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f737c6c0",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4ba86694",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "d83a2082",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:27:02.433359Z",
     "iopub.status.busy": "2022-07-20T13:27:02.433076Z",
     "iopub.status.idle": "2022-07-20T13:27:02.438045Z",
     "shell.execute_reply": "2022-07-20T13:27:02.437358Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f2e6ccf7",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "d002f1af",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:27:02.440648Z",
     "iopub.status.busy": "2022-07-20T13:27:02.440400Z",
     "iopub.status.idle": "2022-07-20T13:27:05.536492Z",
     "shell.execute_reply": "2022-07-20T13:27:05.535812Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "af58c256",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "70bab294",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "0f815ad5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:27:05.539647Z",
     "iopub.status.busy": "2022-07-20T13:27:05.539355Z",
     "iopub.status.idle": "2022-07-20T13:27:05.555040Z",
     "shell.execute_reply": "2022-07-20T13:27:05.554486Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "b4bb760e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-07-20T13:27:05.557800Z",
     "iopub.status.busy": "2022-07-20T13:27:05.557525Z",
     "iopub.status.idle": "2022-07-20T13:27:07.417296Z",
     "shell.execute_reply": "2022-07-20T13:27:07.416715Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68099880889758\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-2.96735859e-04, -4.30340709e-04,  3.97830747e-04,  2.26009893e-06,\n",
       "        4.29147212e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 37\n",
       "      nit: 28\n",
       "     njev: 37\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  2.07005976,   1.74612938,   0.18194306, -15.21875416,\n",
       "        -4.53840856])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1b8b20b1",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
