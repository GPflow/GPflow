{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "c996404c",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "8690f6d0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:12.330435Z",
     "iopub.status.busy": "2022-09-01T16:02:12.329608Z",
     "iopub.status.idle": "2022-09-01T16:02:15.151219Z",
     "shell.execute_reply": "2022-09-01T16:02:15.150655Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.decorator.check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.inheritance.inherit_check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import reduce_in_tests\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0db4eb04",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "e81fe172",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:15.153535Z",
     "iopub.status.busy": "2022-09-01T16:02:15.153241Z",
     "iopub.status.idle": "2022-09-01T16:02:15.155699Z",
     "shell.execute_reply": "2022-09-01T16:02:15.155344Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4a852c71",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "48143596",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:15.157462Z",
     "iopub.status.busy": "2022-09-01T16:02:15.157288Z",
     "iopub.status.idle": "2022-09-01T16:02:15.159605Z",
     "shell.execute_reply": "2022-09-01T16:02:15.159256Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = reduce_in_tests(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "5784f67a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:15.161266Z",
     "iopub.status.busy": "2022-09-01T16:02:15.161094Z",
     "iopub.status.idle": "2022-09-01T16:02:15.236558Z",
     "shell.execute_reply": "2022-09-01T16:02:15.236020Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f1cd3ae6500>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "7d9078c2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:15.238467Z",
     "iopub.status.busy": "2022-09-01T16:02:15.238284Z",
     "iopub.status.idle": "2022-09-01T16:02:15.298387Z",
     "shell.execute_reply": "2022-09-01T16:02:15.297919Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.checker.ShapeChecker.__init__ which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "2022-09-01 17:02:15.261767: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:975] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n",
      "2022-09-01 17:02:15.264906: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory\n",
      "2022-09-01 17:02:15.265376: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1850] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.\n",
      "Skipping registering GPU devices...\n",
      "2022-09-01 17:02:15.265754: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f1cd3b42ef0&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value  </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]</td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.01   </td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f1cd3b42ef0>\n",
       "\u2552\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2555\n",
       "\u2502 name                               \u2502 class     \u2502 transform        \u2502 prior   \u2502 trainable   \u2502 shape   \u2502 dtype   \u2502 value   \u2502\n",
       "\u255e\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2561\n",
       "\u2502 GPR.kernel.kernels[0].variance     \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 1.0     \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.kernel.kernels[0].lengthscales \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 (2,)    \u2502 float64 \u2502 [1. 2.] \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.kernel.kernels[1].variance     \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 1.0     \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.likelihood.variance            \u2502 Parameter \u2502 Softplus + Shift \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 0.01    \u2502\n",
       "\u2558\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255b"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "f0554692",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:15.300298Z",
     "iopub.status.busy": "2022-09-01T16:02:15.300115Z",
     "iopub.status.idle": "2022-09-01T16:02:15.403531Z",
     "shell.execute_reply": "2022-09-01T16:02:15.403071Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "37e9108a",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "de8509bb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:15.406680Z",
     "iopub.status.busy": "2022-09-01T16:02:15.406495Z",
     "iopub.status.idle": "2022-09-01T16:02:15.422441Z",
     "shell.execute_reply": "2022-09-01T16:02:15.421792Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "60af8580",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "a008aa3a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:15.424497Z",
     "iopub.status.busy": "2022-09-01T16:02:15.424339Z",
     "iopub.status.idle": "2022-09-01T16:02:15.427538Z",
     "shell.execute_reply": "2022-09-01T16:02:15.427052Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "45b7788f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:15.429285Z",
     "iopub.status.busy": "2022-09-01T16:02:15.429111Z",
     "iopub.status.idle": "2022-09-01T16:02:16.960829Z",
     "shell.execute_reply": "2022-09-01T16:02:16.960275Z"
    }
   },
   "outputs": [],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "672c4c8c",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c3bf41f7",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "d4b5879f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:16.978678Z",
     "iopub.status.busy": "2022-09-01T16:02:16.978488Z",
     "iopub.status.idle": "2022-09-01T16:02:16.982459Z",
     "shell.execute_reply": "2022-09-01T16:02:16.982019Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1b5d41b2",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "18ed3c09",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:16.984328Z",
     "iopub.status.busy": "2022-09-01T16:02:16.984147Z",
     "iopub.status.idle": "2022-09-01T16:02:18.288601Z",
     "shell.execute_reply": "2022-09-01T16:02:18.288052Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b94c5663",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0e16098a",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "2a856dc3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:18.290864Z",
     "iopub.status.busy": "2022-09-01T16:02:18.290692Z",
     "iopub.status.idle": "2022-09-01T16:02:18.303801Z",
     "shell.execute_reply": "2022-09-01T16:02:18.303363Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "5e681a6b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-01T16:02:18.305726Z",
     "iopub.status.busy": "2022-09-01T16:02:18.305535Z",
     "iopub.status.idle": "2022-09-01T16:02:20.207616Z",
     "shell.execute_reply": "2022-09-01T16:02:20.207086Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68100085183153\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-3.34238737e-04, -4.16767372e-04,  6.72830705e-05,  2.16370933e-07,\n",
       "        8.76085403e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 44\n",
       "      nit: 41\n",
       "     njev: 44\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  1.99416732,   1.80228969,   0.1814142 , -17.56521416,\n",
       "        -4.53839972])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}