{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "8ec05dcc",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "a0f462f7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:21.952881Z",
     "iopub.status.busy": "2022-09-07T14:35:21.952715Z",
     "iopub.status.idle": "2022-09-07T14:35:24.730002Z",
     "shell.execute_reply": "2022-09-07T14:35:24.729401Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.decorator.check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.inheritance.inherit_check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import reduce_in_tests\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1323247a",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2600fb67",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:24.732345Z",
     "iopub.status.busy": "2022-09-07T14:35:24.732083Z",
     "iopub.status.idle": "2022-09-07T14:35:24.734875Z",
     "shell.execute_reply": "2022-09-07T14:35:24.734494Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c139f42f",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "c85fd006",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:24.736739Z",
     "iopub.status.busy": "2022-09-07T14:35:24.736569Z",
     "iopub.status.idle": "2022-09-07T14:35:24.739228Z",
     "shell.execute_reply": "2022-09-07T14:35:24.738767Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = reduce_in_tests(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "f01acd4b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:24.740936Z",
     "iopub.status.busy": "2022-09-07T14:35:24.740791Z",
     "iopub.status.idle": "2022-09-07T14:35:24.816200Z",
     "shell.execute_reply": "2022-09-07T14:35:24.815757Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fee88785d50>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "86ae4ec1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:24.818135Z",
     "iopub.status.busy": "2022-09-07T14:35:24.817920Z",
     "iopub.status.idle": "2022-09-07T14:35:24.873637Z",
     "shell.execute_reply": "2022-09-07T14:35:24.873125Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.checker.ShapeChecker.__init__ which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "2022-09-07 15:35:24.840776: E tensorflow/stream_executor/cuda/cuda_driver.cc:271] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected\n",
      "2022-09-07 15:35:24.840813: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: jesper-desktop\n",
      "2022-09-07 15:35:24.840819: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: jesper-desktop\n",
      "2022-09-07 15:35:24.840878: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 495.29.5\n",
      "2022-09-07 15:35:24.840894: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 495.29.5\n",
      "2022-09-07 15:35:24.840898: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 495.29.5\n",
      "2022-09-07 15:35:24.841352: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7fee887da6b0&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value  </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]</td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.01   </td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7fee887da6b0>\n",
       "\u2552\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2555\n",
       "\u2502 name                               \u2502 class     \u2502 transform        \u2502 prior   \u2502 trainable   \u2502 shape   \u2502 dtype   \u2502 value   \u2502\n",
       "\u255e\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2561\n",
       "\u2502 GPR.kernel.kernels[0].variance     \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 1.0     \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.kernel.kernels[0].lengthscales \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 (2,)    \u2502 float64 \u2502 [1. 2.] \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.kernel.kernels[1].variance     \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 1.0     \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.likelihood.variance            \u2502 Parameter \u2502 Softplus + Shift \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 0.01    \u2502\n",
       "\u2558\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255b"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "f9ad6e39",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:24.875834Z",
     "iopub.status.busy": "2022-09-07T14:35:24.875464Z",
     "iopub.status.idle": "2022-09-07T14:35:24.980421Z",
     "shell.execute_reply": "2022-09-07T14:35:24.979676Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "391fb32a",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "ad3b47ed",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:24.982889Z",
     "iopub.status.busy": "2022-09-07T14:35:24.982625Z",
     "iopub.status.idle": "2022-09-07T14:35:24.997864Z",
     "shell.execute_reply": "2022-09-07T14:35:24.997461Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6dac37e7",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "b45f1b04",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:24.999828Z",
     "iopub.status.busy": "2022-09-07T14:35:24.999647Z",
     "iopub.status.idle": "2022-09-07T14:35:25.002428Z",
     "shell.execute_reply": "2022-09-07T14:35:25.002065Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "e856b85c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:25.004087Z",
     "iopub.status.busy": "2022-09-07T14:35:25.003916Z",
     "iopub.status.idle": "2022-09-07T14:35:26.539756Z",
     "shell.execute_reply": "2022-09-07T14:35:26.539188Z"
    }
   },
   "outputs": [],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "aa53ab70",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "44266ae8",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "8ca30ef4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:26.554517Z",
     "iopub.status.busy": "2022-09-07T14:35:26.554333Z",
     "iopub.status.idle": "2022-09-07T14:35:26.557729Z",
     "shell.execute_reply": "2022-09-07T14:35:26.557358Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2a8b8147",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "c977ea96",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:26.559562Z",
     "iopub.status.busy": "2022-09-07T14:35:26.559388Z",
     "iopub.status.idle": "2022-09-07T14:35:27.858710Z",
     "shell.execute_reply": "2022-09-07T14:35:27.858271Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c6efd535",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "edc6ddd2",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "eed8d83c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:27.860909Z",
     "iopub.status.busy": "2022-09-07T14:35:27.860720Z",
     "iopub.status.idle": "2022-09-07T14:35:27.873713Z",
     "shell.execute_reply": "2022-09-07T14:35:27.873326Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "41ef064f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-07T14:35:27.875542Z",
     "iopub.status.busy": "2022-09-07T14:35:27.875359Z",
     "iopub.status.idle": "2022-09-07T14:35:29.758442Z",
     "shell.execute_reply": "2022-09-07T14:35:29.757922Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68100085183153\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-3.34238737e-04, -4.16767372e-04,  6.72830705e-05,  2.16370933e-07,\n",
       "        8.76085403e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 44\n",
       "      nit: 41\n",
       "     njev: 44\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  1.99416732,   1.80228969,   0.1814142 , -17.56521416,\n",
       "        -4.53839972])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}