{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "c4af921e",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "edecda27",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:25.628353Z",
     "iopub.status.busy": "2022-08-12T09:42:25.628151Z",
     "iopub.status.idle": "2022-08-12T09:42:28.420024Z",
     "shell.execute_reply": "2022-08-12T09:42:28.419448Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.decorator.check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.inheritance.inherit_check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import reduce_in_tests\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "263875b4",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "f1c60941",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:28.422412Z",
     "iopub.status.busy": "2022-08-12T09:42:28.422141Z",
     "iopub.status.idle": "2022-08-12T09:42:28.425160Z",
     "shell.execute_reply": "2022-08-12T09:42:28.424711Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9973c4e3",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "be462d1e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:28.426978Z",
     "iopub.status.busy": "2022-08-12T09:42:28.426811Z",
     "iopub.status.idle": "2022-08-12T09:42:28.429343Z",
     "shell.execute_reply": "2022-08-12T09:42:28.428867Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = reduce_in_tests(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "c984f78b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:28.431074Z",
     "iopub.status.busy": "2022-08-12T09:42:28.430919Z",
     "iopub.status.idle": "2022-08-12T09:42:28.506189Z",
     "shell.execute_reply": "2022-08-12T09:42:28.505755Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f4f58305f60>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "2f099124",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:28.508165Z",
     "iopub.status.busy": "2022-08-12T09:42:28.507964Z",
     "iopub.status.idle": "2022-08-12T09:42:28.575010Z",
     "shell.execute_reply": "2022-08-12T09:42:28.574625Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.checker.ShapeChecker.__init__ which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "2022-08-12 10:42:28.538426: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:975] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n",
      "2022-08-12 10:42:28.541596: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory\n",
      "2022-08-12 10:42:28.542092: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1850] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.\n",
      "Skipping registering GPU devices...\n",
      "2022-08-12 10:42:28.542365: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7f4f5835a8c0&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value  </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]</td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.01   </td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7f4f5835a8c0>\n",
       "\u2552\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2555\n",
       "\u2502 name                               \u2502 class     \u2502 transform        \u2502 prior   \u2502 trainable   \u2502 shape   \u2502 dtype   \u2502 value   \u2502\n",
       "\u255e\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2561\n",
       "\u2502 GPR.kernel.kernels[0].variance     \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 1.0     \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.kernel.kernels[0].lengthscales \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 (2,)    \u2502 float64 \u2502 [1. 2.] \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.kernel.kernels[1].variance     \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 1.0     \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.likelihood.variance            \u2502 Parameter \u2502 Softplus + Shift \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 0.01    \u2502\n",
       "\u2558\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255b"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "9dc9fa2f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:28.576903Z",
     "iopub.status.busy": "2022-08-12T09:42:28.576742Z",
     "iopub.status.idle": "2022-08-12T09:42:28.698431Z",
     "shell.execute_reply": "2022-08-12T09:42:28.697850Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5182c7fa",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "2318cb74",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:28.700591Z",
     "iopub.status.busy": "2022-08-12T09:42:28.700407Z",
     "iopub.status.idle": "2022-08-12T09:42:28.714360Z",
     "shell.execute_reply": "2022-08-12T09:42:28.713831Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "db5e567d",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "319207bc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:28.716490Z",
     "iopub.status.busy": "2022-08-12T09:42:28.716313Z",
     "iopub.status.idle": "2022-08-12T09:42:28.719143Z",
     "shell.execute_reply": "2022-08-12T09:42:28.718772Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "06265ef5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:28.720926Z",
     "iopub.status.busy": "2022-08-12T09:42:28.720780Z",
     "iopub.status.idle": "2022-08-12T09:42:30.291824Z",
     "shell.execute_reply": "2022-08-12T09:42:30.291274Z"
    }
   },
   "outputs": [],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "de11c106",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "257c4c70",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "fa4c4836",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:30.306554Z",
     "iopub.status.busy": "2022-08-12T09:42:30.306332Z",
     "iopub.status.idle": "2022-08-12T09:42:30.310165Z",
     "shell.execute_reply": "2022-08-12T09:42:30.309678Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "61c7edd1",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "edf1283a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:30.312056Z",
     "iopub.status.busy": "2022-08-12T09:42:30.311872Z",
     "iopub.status.idle": "2022-08-12T09:42:31.637307Z",
     "shell.execute_reply": "2022-08-12T09:42:31.636289Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "67e41c00",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c00a866c",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "dd1aa521",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:31.641138Z",
     "iopub.status.busy": "2022-08-12T09:42:31.640812Z",
     "iopub.status.idle": "2022-08-12T09:42:31.656975Z",
     "shell.execute_reply": "2022-08-12T09:42:31.656539Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "acef98c2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-12T09:42:31.659023Z",
     "iopub.status.busy": "2022-08-12T09:42:31.658813Z",
     "iopub.status.idle": "2022-08-12T09:42:33.543812Z",
     "shell.execute_reply": "2022-08-12T09:42:33.543290Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68100085183153\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-3.34238737e-04, -4.16767372e-04,  6.72830705e-05,  2.16370933e-07,\n",
       "        8.76085403e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 44\n",
       "      nit: 41\n",
       "     njev: 44\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  1.99416732,   1.80228969,   0.1814142 , -17.56521416,\n",
       "        -4.53839972])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}