{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "ebd24cea",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "40ef483d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:04.167991Z",
     "iopub.status.busy": "2022-09-02T08:47:04.167789Z",
     "iopub.status.idle": "2022-09-02T08:47:06.969659Z",
     "shell.execute_reply": "2022-09-02T08:47:06.969084Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.decorator.check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.inheritance.inherit_check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import reduce_in_tests\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a2be1777",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "9c144972",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:06.972041Z",
     "iopub.status.busy": "2022-09-02T08:47:06.971737Z",
     "iopub.status.idle": "2022-09-02T08:47:06.974389Z",
     "shell.execute_reply": "2022-09-02T08:47:06.974005Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4600acec",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "67af3e3a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:06.976294Z",
     "iopub.status.busy": "2022-09-02T08:47:06.976114Z",
     "iopub.status.idle": "2022-09-02T08:47:06.978546Z",
     "shell.execute_reply": "2022-09-02T08:47:06.978171Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = reduce_in_tests(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "b2efac8a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:06.980273Z",
     "iopub.status.busy": "2022-09-02T08:47:06.980094Z",
     "iopub.status.idle": "2022-09-02T08:47:07.055337Z",
     "shell.execute_reply": "2022-09-02T08:47:07.054915Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fe474396b00>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "0edce6dc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:07.057286Z",
     "iopub.status.busy": "2022-09-02T08:47:07.057076Z",
     "iopub.status.idle": "2022-09-02T08:47:07.118572Z",
     "shell.execute_reply": "2022-09-02T08:47:07.118048Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.checker.ShapeChecker.__init__ which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "2022-09-02 09:47:07.081706: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:975] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n",
      "2022-09-02 09:47:07.084850: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory\n",
      "2022-09-02 09:47:07.085323: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1850] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.\n",
      "Skipping registering GPU devices...\n",
      "2022-09-02 09:47:07.085693: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7fe4743f2470&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value  </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]</td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.01   </td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7fe4743f2470>\n",
       "\u2552\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2555\n",
       "\u2502 name                               \u2502 class     \u2502 transform        \u2502 prior   \u2502 trainable   \u2502 shape   \u2502 dtype   \u2502 value   \u2502\n",
       "\u255e\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2561\n",
       "\u2502 GPR.kernel.kernels[0].variance     \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 1.0     \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.kernel.kernels[0].lengthscales \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 (2,)    \u2502 float64 \u2502 [1. 2.] \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.kernel.kernels[1].variance     \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 1.0     \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.likelihood.variance            \u2502 Parameter \u2502 Softplus + Shift \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 0.01    \u2502\n",
       "\u2558\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255b"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "a5a81496",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:07.120425Z",
     "iopub.status.busy": "2022-09-02T08:47:07.120228Z",
     "iopub.status.idle": "2022-09-02T08:47:07.225623Z",
     "shell.execute_reply": "2022-09-02T08:47:07.225154Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "73e0d137",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "57063093",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:07.227635Z",
     "iopub.status.busy": "2022-09-02T08:47:07.227437Z",
     "iopub.status.idle": "2022-09-02T08:47:07.239342Z",
     "shell.execute_reply": "2022-09-02T08:47:07.238841Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1d7ef8a7",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "2525d91d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:07.241387Z",
     "iopub.status.busy": "2022-09-02T08:47:07.241193Z",
     "iopub.status.idle": "2022-09-02T08:47:07.244232Z",
     "shell.execute_reply": "2022-09-02T08:47:07.243834Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "5a5142ed",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:07.245997Z",
     "iopub.status.busy": "2022-09-02T08:47:07.245816Z",
     "iopub.status.idle": "2022-09-02T08:47:08.788090Z",
     "shell.execute_reply": "2022-09-02T08:47:08.787560Z"
    }
   },
   "outputs": [],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8495416f",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e04b480f",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "91395e00",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:08.802584Z",
     "iopub.status.busy": "2022-09-02T08:47:08.802366Z",
     "iopub.status.idle": "2022-09-02T08:47:08.806515Z",
     "shell.execute_reply": "2022-09-02T08:47:08.805967Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fddc2019",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "dc33baad",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:08.808623Z",
     "iopub.status.busy": "2022-09-02T08:47:08.808434Z",
     "iopub.status.idle": "2022-09-02T08:47:10.120367Z",
     "shell.execute_reply": "2022-09-02T08:47:10.119883Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "43400604",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ef1e4ffa",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "097b09aa",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:10.122623Z",
     "iopub.status.busy": "2022-09-02T08:47:10.122433Z",
     "iopub.status.idle": "2022-09-02T08:47:10.134810Z",
     "shell.execute_reply": "2022-09-02T08:47:10.134361Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "350e84a1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-09-02T08:47:10.136805Z",
     "iopub.status.busy": "2022-09-02T08:47:10.136604Z",
     "iopub.status.idle": "2022-09-02T08:47:12.023675Z",
     "shell.execute_reply": "2022-09-02T08:47:12.023150Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68100085183153\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-3.34238737e-04, -4.16767372e-04,  6.72830705e-05,  2.16370933e-07,\n",
       "        8.76085403e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 44\n",
       "      nit: 41\n",
       "     njev: 44\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  1.99416732,   1.80228969,   0.1814142 , -17.56521416,\n",
       "        -4.53839972])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}