{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "12a61efa",
   "metadata": {},
   "source": [
    "# Monitoring Optimisation\n",
    "\n",
    "In this notebook we cover how to monitor the model and certain metrics during optimisation.\n",
    "\n",
    "## Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "c8a87ca8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:21.266352Z",
     "iopub.status.busy": "2022-08-15T15:52:21.266153Z",
     "iopub.status.idle": "2022-08-15T15:52:24.062398Z",
     "shell.execute_reply": "2022-08-15T15:52:24.061821Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.decorator.check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.inheritance.inherit_check_shapes which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tensorflow as tf\n",
    "\n",
    "import gpflow\n",
    "from gpflow.ci_utils import reduce_in_tests\n",
    "\n",
    "np.random.seed(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "75bda8cb",
   "metadata": {},
   "source": [
    "The monitoring functionality lives in `gpflow.monitor`.\n",
    "For now, we import `ModelToTensorBoard`, `ImageToTensorBoard`, `ScalarToTensorBoard` monitoring tasks and `MonitorTaskGroup` and `Monitor`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "0f27ac6d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:24.064839Z",
     "iopub.status.busy": "2022-08-15T15:52:24.064561Z",
     "iopub.status.idle": "2022-08-15T15:52:24.067365Z",
     "shell.execute_reply": "2022-08-15T15:52:24.066912Z"
    }
   },
   "outputs": [],
   "source": [
    "from gpflow.monitor import (\n",
    "    ImageToTensorBoard,\n",
    "    ModelToTensorBoard,\n",
    "    Monitor,\n",
    "    MonitorTaskGroup,\n",
    "    ScalarToTensorBoard,\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3e55eb4b",
   "metadata": {},
   "source": [
    "## Set up data and model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "3b200138",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:24.069163Z",
     "iopub.status.busy": "2022-08-15T15:52:24.069020Z",
     "iopub.status.idle": "2022-08-15T15:52:24.071474Z",
     "shell.execute_reply": "2022-08-15T15:52:24.071112Z"
    }
   },
   "outputs": [],
   "source": [
    "# Define some configuration constants.\n",
    "\n",
    "num_data = 100\n",
    "noise_std = 0.1\n",
    "optimisation_steps = reduce_in_tests(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "429c616b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:24.073176Z",
     "iopub.status.busy": "2022-08-15T15:52:24.073007Z",
     "iopub.status.idle": "2022-08-15T15:52:24.148173Z",
     "shell.execute_reply": "2022-08-15T15:52:24.147535Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fa9ddec63b0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create dummy data.\n",
    "\n",
    "X = np.random.randn(num_data, 1)  # [N, 2]\n",
    "Y = np.sin(X) + 0.5 * np.cos(X) + np.random.randn(*X.shape) * noise_std  # [N, 1]\n",
    "plt.plot(X, Y, \"o\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "87fd94a6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:24.150476Z",
     "iopub.status.busy": "2022-08-15T15:52:24.150179Z",
     "iopub.status.idle": "2022-08-15T15:52:24.214582Z",
     "shell.execute_reply": "2022-08-15T15:52:24.214198Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/jesper/src/GPflow/gpflow/experimental/utils.py:42: UserWarning: You're calling gpflow.experimental.check_shapes.checker.ShapeChecker.__init__ which is considered *experimental*. Expect: breaking changes, poor documentation, and bugs.\n",
      "  warn(\n",
      "2022-08-15 16:52:24.177660: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:975] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\n",
      "2022-08-15 16:52:24.180758: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory\n",
      "2022-08-15 16:52:24.181256: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1850] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.\n",
      "Skipping registering GPU devices...\n",
      "2022-08-15 16:52:24.181900: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA\n",
      "To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "&lt;gpflow.models.gpr.GPR object at 0x7fa9ddf1f1c0&gt;\n",
       "<table>\n",
       "<thead>\n",
       "<tr><th>name                              </th><th>class    </th><th>transform       </th><th>prior  </th><th>trainable  </th><th>shape  </th><th>dtype  </th><th>value  </th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "<tr><td>GPR.kernel.kernels[0].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.kernel.kernels[0].lengthscales</td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>(2,)   </td><td>float64</td><td>[1. 2.]</td></tr>\n",
       "<tr><td>GPR.kernel.kernels[1].variance    </td><td>Parameter</td><td>Softplus        </td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>1.0    </td></tr>\n",
       "<tr><td>GPR.likelihood.variance           </td><td>Parameter</td><td>Softplus + Shift</td><td>       </td><td>True       </td><td>()     </td><td>float64</td><td>0.01   </td></tr>\n",
       "</tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<gpflow.models.gpr.GPR object at 0x7fa9ddf1f1c0>\n",
       "\u2552\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2555\n",
       "\u2502 name                               \u2502 class     \u2502 transform        \u2502 prior   \u2502 trainable   \u2502 shape   \u2502 dtype   \u2502 value   \u2502\n",
       "\u255e\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2561\n",
       "\u2502 GPR.kernel.kernels[0].variance     \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 1.0     \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.kernel.kernels[0].lengthscales \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 (2,)    \u2502 float64 \u2502 [1. 2.] \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.kernel.kernels[1].variance     \u2502 Parameter \u2502 Softplus         \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 1.0     \u2502\n",
       "\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n",
       "\u2502 GPR.likelihood.variance            \u2502 Parameter \u2502 Softplus + Shift \u2502         \u2502 True        \u2502 ()      \u2502 float64 \u2502 0.01    \u2502\n",
       "\u2558\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255b"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Set up model and print\n",
    "\n",
    "kernel = gpflow.kernels.SquaredExponential(lengthscales=[1.0, 2.0]) + gpflow.kernels.Linear()\n",
    "model = gpflow.models.GPR((X, Y), kernel, noise_variance=noise_std ** 2)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "9f275934",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:24.216427Z",
     "iopub.status.busy": "2022-08-15T15:52:24.216268Z",
     "iopub.status.idle": "2022-08-15T15:52:24.336697Z",
     "shell.execute_reply": "2022-08-15T15:52:24.336183Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# We define a function that plots the model's prediction (in the form of samples) together with the data.\n",
    "# Importantly, this function has no other argument than `fig: matplotlib.figure.Figure` and `ax: matplotlib.figure.Axes`.\n",
    "\n",
    "\n",
    "def plot_prediction(fig, ax):\n",
    "    Xnew = np.linspace(X.min() - 0.5, X.max() + 0.5, 100).reshape(-1, 1)\n",
    "    Ypred = model.predict_f_samples(Xnew, full_cov=True, num_samples=20)\n",
    "    ax.plot(Xnew.flatten(), np.squeeze(Ypred).T, \"C1\", alpha=0.2)\n",
    "    ax.plot(X, Y, \"o\")\n",
    "\n",
    "\n",
    "# Let's check if the function does the desired plotting\n",
    "fig = plt.figure()\n",
    "ax = fig.subplots()\n",
    "plot_prediction(fig, ax)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "703337c8",
   "metadata": {},
   "source": [
    "## Set up monitoring tasks\n",
    "\n",
    "We now define the `MonitorTask`s that will be executed during the optimisation.\n",
    "For this tutorial we set up three tasks:\n",
    "- `ModelToTensorBoard`: writes the models hyper-parameters such as `likelihood.variance` and `kernel.lengthscales` to a TensorBoard.\n",
    "- `ImageToTensorBoard`: writes custom matplotlib images to a TensorBoard.\n",
    "- `ScalarToTensorBoard`: writes any scalar value to a TensorBoard. Here, we use it to write the model's training objective."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "58f65234",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:24.338672Z",
     "iopub.status.busy": "2022-08-15T15:52:24.338482Z",
     "iopub.status.idle": "2022-08-15T15:52:24.351857Z",
     "shell.execute_reply": "2022-08-15T15:52:24.351453Z"
    }
   },
   "outputs": [],
   "source": [
    "log_dir = \"logs\"  # Directory where TensorBoard files will be written.\n",
    "model_task = ModelToTensorBoard(log_dir, model)\n",
    "image_task = ImageToTensorBoard(log_dir, plot_prediction, \"image_samples\")\n",
    "lml_task = ScalarToTensorBoard(log_dir, lambda: model.training_loss(), \"training_objective\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "76b3caec",
   "metadata": {},
   "source": [
    "We now group the tasks in a set of fast and slow tasks and pass them to the monitor.\n",
    "This allows us to execute the groups at a different frequency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "dbdca658",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:24.353933Z",
     "iopub.status.busy": "2022-08-15T15:52:24.353734Z",
     "iopub.status.idle": "2022-08-15T15:52:24.356740Z",
     "shell.execute_reply": "2022-08-15T15:52:24.356376Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Plotting tasks can be quite slow. We want to run them less frequently.\n",
    "# We group them in a `MonitorTaskGroup` and set the period to 5.\n",
    "slow_tasks = MonitorTaskGroup(image_task, period=5)\n",
    "\n",
    "# The other tasks are fast. We run them at each iteration of the optimisation.\n",
    "fast_tasks = MonitorTaskGroup([model_task, lml_task], period=1)\n",
    "\n",
    "# Both groups are passed to the monitor.\n",
    "# `slow_tasks` will be run five times less frequently than `fast_tasks`.\n",
    "monitor = Monitor(fast_tasks, slow_tasks)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "9a88a2d6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:24.358572Z",
     "iopub.status.busy": "2022-08-15T15:52:24.358384Z",
     "iopub.status.idle": "2022-08-15T15:52:25.901288Z",
     "shell.execute_reply": "2022-08-15T15:52:25.900711Z"
    }
   },
   "outputs": [],
   "source": [
    "training_loss = model.training_loss_closure(\n",
    "    compile=True\n",
    ")  # compile=True (default): compiles using tf.function\n",
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "for step in range(optimisation_steps):\n",
    "    opt.minimize(training_loss, model.trainable_variables)\n",
    "    monitor(step)  # <-- run the monitoring"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9f89f3a0",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "TensorBoard is accessible through the browser, after launching the server by running `tensorboard --logdir ${logdir}`.\n",
    "See the [TensorFlow documentation on TensorBoard](https://www.tensorflow.org/tensorboard/get_started) for more information."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1710a55e",
   "metadata": {},
   "source": [
    "### For optimal performance, we can also wrap the monitor call inside `tf.function`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "4ef845f4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:25.918517Z",
     "iopub.status.busy": "2022-08-15T15:52:25.918332Z",
     "iopub.status.idle": "2022-08-15T15:52:25.922160Z",
     "shell.execute_reply": "2022-08-15T15:52:25.921713Z"
    },
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "opt = tf.optimizers.Adam()\n",
    "\n",
    "log_dir_compiled = f\"{log_dir}/compiled\"\n",
    "model_task = ModelToTensorBoard(log_dir_compiled, model)\n",
    "lml_task = ScalarToTensorBoard(\n",
    "    log_dir_compiled, lambda: model.training_loss(), \"training_objective\"\n",
    ")\n",
    "# Note that the `ImageToTensorBoard` task cannot be compiled, and is omitted from the monitoring\n",
    "monitor = Monitor(MonitorTaskGroup([model_task, lml_task]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6688ca7d",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "In the optimisation loop below we use `tf.range` (rather than Python's built-in range) to avoid re-tracing the `step` function each time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "5f7615ff",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:25.924046Z",
     "iopub.status.busy": "2022-08-15T15:52:25.923868Z",
     "iopub.status.idle": "2022-08-15T15:52:27.220179Z",
     "shell.execute_reply": "2022-08-15T15:52:27.219726Z"
    }
   },
   "outputs": [],
   "source": [
    "@tf.function\n",
    "def step(i):\n",
    "    opt.minimize(model.training_loss, model.trainable_variables)\n",
    "    monitor(i)\n",
    "\n",
    "\n",
    "# Notice the tf.range\n",
    "for i in tf.range(optimisation_steps):\n",
    "    step(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ca0d2740",
   "metadata": {},
   "source": [
    "When opening TensorBoard, you may need to use the command `tensorboard --logdir . --reload_multifile=true`, as multiple `FileWriter` objects are used."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0e244032",
   "metadata": {},
   "source": [
    "### Scipy Optimization monitoring\n",
    "\n",
    "Note that if you want to use the `Scipy` optimizer provided by GPflow, and want to monitor the training progress, then you need to simply replace\n",
    "the optimization loop with a single call to its `minimize` method and pass in the monitor as a `step_callback` keyword argument:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "fa6b8d77",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:27.222473Z",
     "iopub.status.busy": "2022-08-15T15:52:27.222280Z",
     "iopub.status.idle": "2022-08-15T15:52:27.234265Z",
     "shell.execute_reply": "2022-08-15T15:52:27.233770Z"
    }
   },
   "outputs": [],
   "source": [
    "opt = gpflow.optimizers.Scipy()\n",
    "\n",
    "log_dir_scipy = f\"{log_dir}/scipy\"\n",
    "model_task = ModelToTensorBoard(log_dir_scipy, model)\n",
    "lml_task = ScalarToTensorBoard(log_dir_scipy, lambda: model.training_loss(), \"training_objective\")\n",
    "image_task = ImageToTensorBoard(log_dir_scipy, plot_prediction, \"image_samples\")\n",
    "\n",
    "monitor = Monitor(\n",
    "    MonitorTaskGroup([model_task, lml_task], period=1), MonitorTaskGroup(image_task, period=5)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "f4f7c5f7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-15T15:52:27.236224Z",
     "iopub.status.busy": "2022-08-15T15:52:27.236036Z",
     "iopub.status.idle": "2022-08-15T15:52:29.127272Z",
     "shell.execute_reply": "2022-08-15T15:52:29.126747Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "      fun: -69.68100085183153\n",
       " hess_inv: <5x5 LbfgsInvHessProduct with dtype=float64>\n",
       "      jac: array([-3.34238737e-04, -4.16767372e-04,  6.72830705e-05,  2.16370933e-07,\n",
       "        8.76085403e-04])\n",
       "  message: 'CONVERGENCE: REL_REDUCTION_OF_F_<=_FACTR*EPSMCH'\n",
       "     nfev: 44\n",
       "      nit: 41\n",
       "     njev: 44\n",
       "   status: 0\n",
       "  success: True\n",
       "        x: array([  1.99416732,   1.80228969,   0.1814142 , -17.56521416,\n",
       "        -4.53839972])"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "opt.minimize(training_loss, model.trainable_variables, step_callback=monitor)"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,.pct.py:percent"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}